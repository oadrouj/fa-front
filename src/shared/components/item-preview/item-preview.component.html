<div id="contentToConvert" #pdfTable 
[ngClass]="{
    'html2canvas a4-page': this.printingMode, 
    'margin-top-page': !this.printingMode 
}">
    <div class="content pt-4"> 
        <div class="grid px-1">
            <div class="col-5 pt-1">
                <img *ngIf="logoSrc" [src]="logoSrc" class="h-100" alt="">
            </div>
            <div class="col-7 text-right">
                <h2>{{title + ' ' + (item && item.reference)}}
                </h2>
                <span style="font-size:0.9rem;" class="date block line-height-1">Date d'émission: {{item && item.dateEmission | date:'shortDate'}}
                </span>
                <span style="font-size:0.9rem;" class="date block line-height-1">
                    Date d'échéance:
                    {{item && getDateEcheance(item.dateEmission, item.echeancePaiement) | date:'shortDate'}}
                </span>
            </div>
        </div>
        <div class="grid px-2 pt-3">
            <div class="col-7 grid">
                <div class="col-2">
                    <span class="color-gray">Pour:</span>
                </div>
                <div class="col-10  flex flex-column ">
                    <ng-container *ngIf="item && item.client">
                        <div class="grid w-100">
                            <div class="col-12">
                                <span >{{item.client.displayName}} </span>
                            </div>
                            <div class="col-12">
                                <span>{{item.client.adresse}} </span>
                            </div>
                            <div class="col-12">
                                <span>{{item.client.ville}}
                                    {{item.client.codePostal}} </span>
                            </div>
                            <div class="col-12">
                                <span>{{item.client.pays}} </span>
                            </div>
                            <div class="col-12">
                                <span class="mt-2">{{item.client.telPortable}} </span>
                            </div>
                        </div>
                       
                    </ng-container>
                    
                </div>
              
            </div>
            <div class="col-5 grid">
                <div class="col-2">
                    <span class="block color-gray">De:</span>
                </div>
                <div class="col-10 flex flex-column">
                    <div class="grid w-100">
                        <ng-container *ngIf="item">
                            <div class="col-12">
                                <span class="word-wrap-break">{{getEntrepriseName}}</span>
                            </div>
                            <div class="col-12">
                                <span>{{infosEntreprise.adresse}}</span>
                            </div>
                            <div class="col-12">
                                <span>{{infosEntreprise.ville}}
                                    {{infosEntreprise.codePostal}}</span>
                            </div>
                            <div class="col-12">
                                <span style="font-size:0.95rem;">{{infosEntreprise.pays}}</span>
                            </div>
                            <div class="col-12">
                                <span class="mt-3">{{infosEntreprise.telephone}}</span>
                            </div>
                        </ng-container>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="pageHeader" class="mt-1 ml-2 mb-4" style="width:80%;font-size:14px;">
       <!--  <span #showObjet class='font-semibold showObjet'>Objet: </span> -->
       <ng-container *ngIf="this.item">
        <span *ngIf="this.item.messageIntroduction && this.item.messageIntroduction.length > 0 && this.item.messageIntroduction.length <= 148  ">{{this.item.messageIntroduction | slice: 0:148}}</span>
        <span *ngIf="this.item.messageIntroduction && this.item.messageIntroduction.length == 0">{{""}}</span>
        <span *ngIf="this.item.messageIntroduction && this.item.messageIntroduction.length > 148">{{this.item.messageIntroduction | slice: 0:148}}..</span>
       </ng-container> 
    </div>

    <p-table [columns]="contentItemsCols" [value]="item && (item.devisItems || item.factureItems)">
        <ng-template pTemplate="header" let-yourColumnArrayVaraible>
            <tr>
                <ng-container *ngFor="let colVar of yourColumnArrayVaraible">
                    <th [colSpan]="colVar.colspan">
                        {{colVar.header}}
                    </th>
                </ng-container>

            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-yourRowVaraible let-yourColumnArrayVaraible="columns">
            <tr>
                <ng-container *ngFor="let colVar of yourColumnArrayVaraible">
                    <ng-container [ngSwitch]="colVar.type">
                        <ng-container *ngSwitchCase="'date'">
                            <td [colSpan]="colVar.colspan">
                                {{yourRowVaraible[colVar.field] | date:'shortDate'}}
                            </td>
                        </ng-container>
                        <ng-container *ngSwitchCase="'currency'">
                            <td [colSpan]="colVar.colspan" mode="decimal">
                                {{yourRowVaraible[colVar.field] | number:'1.2-2' }} <!-- {{' ' + (item && item.currency)}} -->
                            </td>
                        </ng-container>
                        <ng-container *ngSwitchCase="'pourcentage'">
                            <td [colSpan]="colVar.colspan">
                                {{yourRowVaraible[colVar.field] + '%'}}
                            </td>
                        </ng-container>

                        <ng-container *ngSwitchDefault>
                            <td [colSpan]="colVar.colspan">
                                {{yourRowVaraible[colVar.field]}}
                            </td>
                        </ng-container>

                    </ng-container>

                </ng-container>

            </tr>
        </ng-template>
        <ng-template pTemplate="summary" let-yourColumnArrayVaraible>

            <div class="grid">
                <div class="col-md-7">
                    <span>MONTANT TOTAL HT</span>
                </div>
                <div class="col-xl-5">
                    <span>{{this.summaryTotalHT | number:'1.2-2' }}
                        {{' ' + (item && item.currency)}}</span>
                </div>
            </div>

            <div class="grid">
                <div class="col-7">
                    <span>REMISE</span>
                </div>
                <div class="col-5">
                    <span>{{(item ?  this.remiseAmount : 0) | number:'1.2-2' }}
                        {{' ' + (item && item.currency)}}</span>
                </div>
            </div>

            <div class="grid ">
                <div class="col-md-7">
                    <span>TVA</span>
                </div>
                <div class="col-md-5">
                    <span>{{this.summaryTVA | number:'1.2-2' }}
                        {{' ' + (item && item.currency)}}</span>
                </div>
            </div>

            <hr>

            <div class="grid">
                <div class="col-md-7">
                    <span>TOTAL ESTIME TTC</span>
                </div>
                <div class="col-md-5">
                    <span>{{(item ? this.item.montantTtc : 0) | number:'1.2-2' }}
                        {{' ' + (item && item.currency)}}</span>
                </div>
            </div>
        </ng-template>
    </p-table>

    <div id="pageFooter" class="" 
    [ngClass]="{
        'absolute-footer': this.printingMode, 
        'margin-top-footer': !this.printingMode 
    }">
        <span class="text-center">{{ this.item && this.item.piedDePage || '' }}</span>
    </div>
</div>
